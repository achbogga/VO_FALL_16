Parts of this report are not exactly the same as the algorithm implemented here.
These parts would soon be updated.